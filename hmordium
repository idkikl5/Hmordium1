local Players = game:GetService("Players")
local RunService = game:GetService("RunService")

local LP = Players.LocalPlayer

-- Use a global variable to track if the script is already running
if _G.ForceEquipActive then
    -- Disable the script
    if _G.ForceEquipConnection then
        _G.ForceEquipConnection:Disconnect()
        _G.ForceEquipConnection = nil
    end
    if _G.CharacterAddedConnection then
        _G.CharacterAddedConnection:Disconnect()
        _G.CharacterAddedConnection = nil
    end
    _G.ForceEquipActive = false
    print("ForceEquip script disabled.")
    return
end

-- Mark the script as active
_G.ForceEquipActive = true

local function forceEquip()
    local char = LP.Character
    if not char then return end
    local humanoid = char:FindFirstChildWhichIsA("Humanoid")
    if not humanoid then return end
    local sword = LP.Backpack:FindFirstChild("Sword")
    if sword and not char:FindFirstChild("Sword") then
        humanoid:EquipTool(sword)
    end
end

-- Connect RenderStepped
_G.ForceEquipConnection = RunService.RenderStepped:Connect(forceEquip)

-- Connect CharacterAdded
_G.CharacterAddedConnection = LP.CharacterAdded:Connect(function(char)
    char:WaitForChild("Humanoid")
    char:WaitForChild("HumanoidRootPart")
    forceEquip()
end)

print("ForceEquip script enabled.")
